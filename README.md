# 🧠 LumenSlate Backend Repository

This is the backend server for managing **Assignments** with support for all question types and full academic structures:
- Multiple Choice Questions (MCQ)
- Multiple Select Questions (MSQ)
- Numerical Answer Type (NAT)
- Subjective Questions
- Classroom, Students, Teachers, Comments, Submissions, Posts, Variables, and Question Banks

---

## 🚀 Tech Stack

- Go (Golang)
- Gin Web Framework
- MongoDB
- Swagger Docs (Swaggo)
- gRPC (Protobuf)
- Modular MVC-style structure

---

## 📁 Project Structure

```
server/
├── main.go                  # Main application entrypoint
├── internal/
│   ├── controller/          # HTTP handlers
│   ├── grpc_service/        # gRPC client logic
│   ├── proto/               # Protobuf definitions and generated code
│   ├── db/                  # Database connection logic
│   ├── routes/              # Gin routes setup
│   ├── model/               # Data models (Assignment, MCQ, etc.)
│   └── docs/                # Swagger docs (autogenerated)
├── Makefile                 # Automation for build/run/docs/proto
├── .env                     # Environment variables (not committed)
└── README.md
```

---



## ☸️ Kubernetes Deployment (Local & Production)

### 1. Build & Push Docker Image

Build your Docker image and push it to your container registry:

```bash
docker build -t <your-dockerhub-username>/lumenslate-server:latest .
docker push <your-dockerhub-username>/lumenslate-server:latest
```

Update the `image:` field in the appropriate deployment manifest with your image name.

### 2. Choose Environment

- **Local development:** Use manifests in `k8s/configmap-local.yaml` and `k8s/deployment-local.yaml` (debug mode, local DB, etc.)
- **Production:** Use manifests in `k8s/configmap-prod.yaml` and `k8s/deployment-prod.yaml` (release mode, production DB, resource limits, etc.)

### 3. Deploy to Kubernetes

Apply the ConfigMap and Deployment manifests for your environment:

**Local:**
```bash
kubectl apply -f k8s/configmap-local.yaml
kubectl apply -f k8s/deployment-local.yaml
```

**Production:**
```bash
kubectl apply -f k8s/configmap-prod.yaml
kubectl apply -f k8s/deployment-prod.yaml
```

This will create the Deployment, Service, and ConfigMap for your app.

### 4. Access the Service

If running locally (e.g., with minikube):

```bash
minikube service lumenslate-server-local
```

Or, port-forward manually:

```bash
kubectl port-forward svc/lumenslate-server-local 8080:80
```

For production, use your cloud provider's LoadBalancer or Ingress as appropriate.

---

## 📦 Local Setup Instructions

### 1. Install Go Dependencies

```bash
go mod tidy
```

### 2. Generate Protobuf Go Code

Make sure you have `protoc`, `protoc-gen-go`, and `protoc-gen-go-grpc` installed and in your PATH.

```bash
make proto
```

### 3. Generate Swagger Docs

```bash
make swagger
```

### 4. Run the Server

```bash
make run
```

Or run directly:
```bash
go run main.go
```

---

## 🧪 API Testing

### ✅ Swagger UI

Access at: [http://localhost:8080/docs/index.html](http://localhost:8080/docs/index.html)

### ✅ Postman Collections

Use the provided Postman collections in `/mnt/data` or root directory:
- `Assignment.postman_collection.json`
- `Classroom.postman_collection.json`
- `Comments.postman_collection.json`
- `Posts.postman_collection.json`
- `QuestionBank.postman_collection.json`
- `Students.postman_collection.json`
- `Submission.postman_collection.json`
- `Teachers.postman_collection.json`
- `Variables.postman_collection.json`
- `MCQ.postman_collection.json`
- `MSQ.postman_collection.json`
- `NAT.postman_collection.json`
- `Subjective.postman_collection.json`

Tested features:
- Create, Get, Update, Delete
- Filters: `points`, `dueDate`, `topic`, `chapter`, `teacherId`, etc.
- Pagination: `limit`, `offset`
- Partial update via PATCH

---

## 📝 Sample .env File

```env
PORT=8080
MONGO_URI=your-mongodb-uri
# ...other environment variables...
```

---

## 📌 Make Commands

```bash
make run         # Run server
make swagger     # Generate Swagger docs
make proto       # Generate protobuf Go code
make build       # Build binary
make clean       # Clean build + docs
```

---